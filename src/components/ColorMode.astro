---
const { class: className } = Astro.props
---

<span
  class:list={['i-carbon-moon dark:i-carbon-sun', 'components-color-mode', className]}
  id="toggle-theme"
  aria-label="auto"
></span>

<script>
  const themeKey = 'theme'
  const colorModeEl = document.querySelector('.components-color-mode')
  const colorMode = localStorage.getItem(themeKey)
  if (colorMode === 'dark') {
    document.documentElement.classList.add('dark')
  }
  colorModeEl?.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark')
    if (isDark) {
      document.documentElement.classList.remove('dark')
      localStorage.setItem(themeKey, 'light')
    } else {
      document.documentElement.classList.add('dark')
      localStorage.setItem(themeKey, 'dark')
    }
  })
</script>
